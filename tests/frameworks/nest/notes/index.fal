/*
   FALCON - The Falcon Programming Language

   Nest - Falcon web applcation engine

   FILE: index.fal

   Test - Notes site.
   -------------------------------------------------------------------
   Author: Giancarlo Niccolai
   Begin: Sat, 26 Jun 2010 14:21:48 +0200

   -------------------------------------------------------------------
   (C) Copyright 2010: the FALCON developers (see list in AUTHORS file)

   See LICENSE file for licensing details.
*/

load nest
import from hash

/*
Nest.debug = true
Nest.log_level = 3
Nest.pcheck = true
GC.enable(false)
*/

Nest.stylesheets += "notes.css"
Nest.addHook( "DBCheckUser" )

Nest.onStartup = function()
   dm = Nest.dm( "notes_db" )

   if dm.dbc == nil and Nest.pid != "create"
      Reply.redirect( Nest.pageLink("create") )
      return
   end

   login = Nest.service("Login")
end

Nest.route()
