/****************************************************************************
* Falcon test suite
*
* CVS-Id: $Id: passin.fal,v 1.1.1.1 2006/10/08 15:05:43 gian Exp $
*
* ID: 19b
* Category: pass
* Subcategory:
* Short: Pass in test
* Description:
* Testing the keyword "pass in" for function intercept.
* The pass/passin couple will be tested also in object/class tests
* [/Description]
*
****************************************************************************/

function proxied_one( param1, param2 )
   return paramCount()
end

function proxy( param1, param2 )
   pass proxied_one in result
   if result != paramCount(): failure( "proxy 1" )
   return result
end


// paramCount always return at minimum the fixed param count
if proxy( 1 ) != 2: failure( "Basic pass in / 1" )
if proxy( 1, 2 ) != 2: failure( "Basic pass in / 2" )
if proxy( 1, 2, 3 ) != 3: failure( "Basic pass in / 3" )
if proxy( 1, 2, 3, 4 ) != 4: failure( "Basic pass in/ 4" )

function proxied_two( param1, param2 )
   val = param1 + param2

   // RELEVANT: force to be upfold
   for i = 2 to paramCount() - 1 step 1
      val += paramNumber( i )
   end

   return val
end

glob = proxied_two

function proxy_two()

   // RELEVANT: force to be upfold
   val = 0
   for i = 0 to paramCount() - 1 step 1
      val += paramNumber( i )
   end

   pass glob in result

   if result != val: failure( "proxy 2" )
   return result
end


if proxy_two( 1, 2 ) != 3: failure( "Advanced pass / 1" )
if proxy_two( 1, 2, 3 ) != 6: failure( "Advanced pass / 2" )
if proxy_two( 1, 2, 3, 4 ) != 10: failure( "Advanced pass / 3" )

success()

/* End of file */
