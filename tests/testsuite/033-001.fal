/*
@name BitBuf simple write test
@category Feathers-bitbuf

@output
Test 1: OK!
Test 2: OK!
Test 3: OK!
Test 4: OK!
Test 5: OK!
Test 6: OK!
Test 7: OK!
Test 8: OK!
Done
@endoutput
*/

load bitbuf

tests =  .[
   .[ "Hello world", -1 0
      "0100100001100101011011000110110001101111001000000111011101101111011100100110110001100100" ]

   .[ "Hello world" 75 0
      "010010000110010101101100011011000110111100100000011101110110111101110010011" ]

   .[ "Hello world" 75 1
      "100100001100101011011000110110001101111001000000111011101101111011100100110" ]

   .[ "Hello world" 75 2
      "001000011001010110110001101100011011110010000001110111011011110111001001101" ]

   .[ "Hello world" 75 8
      "011001010110110001101100011011110010000001110111011011110111001001101100011" ]
      
   .[ "Hello world" 75 9
      "110010101101100011011000110111100100000011101110110111101110010011011000110" ]
      
   .[ "Hello world" 75 16
      "011011000110110001101111001000000111011101101111011100100110110001100100" ]

   .[ "Hello world" 75 17
      "11011000110110001101111001000000111011101101111011100100110110001100100" ]
]

count = 0
for string, start, stop, result in tests
   ++ count
   >> "Test ", count, ": "
   x = BitBuf()
   x.write( string, start, stop )
   if x.toString() != result
      > "Fail"
   else
      > "OK!"
   end
end

> "Done"
