/*
@name Finally in continue and break with for/to
@category Complex tests

Like test 100-003, but using for/to.

@output
Sum 0
Summing current element 1
Finally count: 1
Sum 1
Summing current element 2
Finally count: 2
Sum 3
Summing current element 3
Finally count: 3
Sum 6
Summing current element a
Error caught for a
Finally count: 4
Sum 6
Found Nil, continuing
Finally count: 5
Sum 6
Breaking out of the loop
Finally count: 6
Results:
Count: 6
Sum: 6
@endoutput
*/


array = [1,2,3,"a", nil, "b", 5,6,7]
sum = 0
count = 0
test = 0

x = VMContext
dd = x.dataDepth

for i = 0 to array.len
   elem = array[i]
   > "Sum ", sum
   try
      // break here
      if not elem
         > "Found Nil, continuing"
         continue
      end
      
      if elem == "b"
         > "Breaking out of the loop"
         break
      end
      
      > "Summing current element ", elem
      sum += elem
      
   catch in e
      > "Error caught for ", elem
   finally
      > "Finally count: ", ++count
   end
   
end

dd1 = x.dataDepth

if dd1 != dd
   raise "Data depth corruption " + dd1 + "/" + dd
end

> "Results:"
> "Count: ", count
> "Sum: ", sum

   