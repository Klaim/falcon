load dbi
load sample_db

function showNames( message, d )
	> message
   > "=========================================="
   
   rs = d.query( "SELECT * FROM names" )
   while ( let p = rs.fetchObject( Person() ) )
   	> p.name, " was born on ", p.dob
   end
   rs.close()
   >
end

d = connect()
createNamesTable( d )

ts = TimeStamp()
ts.currentTime()

showNames( "Before inserting Jack", d )

t = Person( "Jack", ts )
t.insert()
showNames( "After insertion of Jack via Object Persistence", d )

t.dob.year = 2001
t.update()
showNames( "Changed year to 2001 via Object Persistence", d )

t.delete()
showNames( "After deleting Jack via Object Persistence", d )

dropNamesTable( d )
d.close()
